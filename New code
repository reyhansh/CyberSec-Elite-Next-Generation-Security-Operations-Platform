import React, { useState, useEffect } from 'react';
import { Shield, Eye, AlertTriangle, Key, Network, Activity, Search, Zap, Brain, Bug, Terminal, Clock, CheckCircle, Copy, Check, RefreshCw, Target, BarChart3, Hash, Lock, Globe, Wifi, Code, FileText, Database, Cpu, Server, Binary } from 'lucide-react';
import { AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, PieChart, Pie, Cell } from 'recharts';

export default function CyberSecurityToolkit() {
  const [activeTab, setActiveTab] = useState('dashboard');
  const [threats, setThreats] = useState([]);
  const [aiInsights, setAiInsights] = useState([]);
  const [vulnerabilities, setVulnerabilities] = useState([]);
  const [alerts, setAlerts] = useState([]);
  const [metrics, setMetrics] = useState([]);
  const [credentials, setCredentials] = useState([]);
  const [scanning, setScanning] = useState(false);
  const [aiAnalyzing, setAiAnalyzing] = useState(false);
  const [passwordConfig, setPasswordConfig] = useState({ length: 32, upper: true, lower: true, numbers: true, symbols: true });
  const [generatedPassword, setGeneratedPassword] = useState('');
  const [copied, setCopied] = useState(false);
  
  // Hash calculator
  const [hashInput, setHashInput] = useState('');
  const [hashResults, setHashResults] = useState(null);
  
  // Port scanner
  const [targetIP, setTargetIP] = useState('');
  const [portScanResults, setPortScanResults] = useState([]);
  const [portScanning, setPortScanning] = useState(false);
  
  // Encryption tool
  const [encryptText, setEncryptText] = useState('');
  const [encryptKey, setEncryptKey] = useState('');
  const [encryptedResult, setEncryptedResult] = useState('');
  
  // Base64 encoder/decoder
  const [base64Input, setBase64Input] = useState('');
  const [base64Output, setBase64Output] = useState('');
  const [base64Mode, setBase64Mode] = useState('encode');
  
  // SQL Injection tester
  const [sqlInput, setSqlInput] = useState('');
  const [sqlResults, setSqlResults] = useState([]);
  
  // XSS payload generator
  const [xssPayloads, setXssPayloads] = useState([]);

  useEffect(() => {
    loadData();
    const interval = startMonitoring();
    return () => clearInterval(interval);
  }, []);

  const loadData = async () => {
    try {
      const keys = ['threats-tools', 'ai-tools', 'vulns-tools', 'alerts-tools', 'creds-tools'];
      const results = await Promise.all(keys.map(k => window.storage.get(k).catch(() => null)));

      if (results[0]) setThreats(JSON.parse(results[0].value));
      if (results[1]) setAiInsights(JSON.parse(results[1].value));
      if (results[2]) setVulnerabilities(JSON.parse(results[2].value));
      if (results[3]) setAlerts(JSON.parse(results[3].value));
      if (results[4]) setCredentials(JSON.parse(results[4].value));

      if (!results[0]) initData();
    } catch (error) {
      initData();
    }
  };

  const initData = () => {
    const t = [
      { id: 1, name: 'APT41 Supply Chain Attack', severity: 'critical', desc: 'Backdoor detected in build pipeline', confidence: 98, iocs: ['45.33.32.156', 'SHA256:a3f4b2c...'] },
      { id: 2, name: 'LockBit Ransomware', severity: 'critical', desc: 'Active encryption detected', confidence: 97, iocs: ['lockbit.onion', 'Process:encrypt.exe'] },
      { id: 3, name: 'Credential Theft', severity: 'high', desc: 'Kerberoasting attack detected', confidence: 94, iocs: ['GetUserSPNs.py', 'admin@domain.local'] }
    ];

    const v = [
      { id: 1, cve: 'CVE-2024-21626', cvss: 9.9, software: 'runc < 1.1.12', desc: 'Container escape vulnerability', exploit: true, affected: 47 },
      { id: 2, cve: 'CVE-2024-4577', cvss: 9.8, software: 'PHP 8.1.0-8.1.28', desc: 'RCE via argument injection', exploit: true, affected: 23 }
    ];

    const met = Array.from({ length: 12 }, (_, i) => ({
      hour: `${(new Date().getHours() - 11 + i) % 24}:00`,
      threats: Math.floor(Math.random() * 60) + 20,
      blocked: Math.floor(Math.random() * 55) + 18
    }));

    setThreats(t);
    setVulnerabilities(v);
    setMetrics(met);
    save('threats-tools', t);
    save('vulns-tools', v);
  };

  const save = async (key, data) => {
    try {
      await window.storage.set(key, JSON.stringify(data));
    } catch (error) {
      console.error('Storage error:', error);
    }
  };

  const startMonitoring = () => {
    return setInterval(() => {
      const msgs = [
        { msg: 'Port scan detected from 203.0.113.45', severity: 'high' },
        { msg: 'SQL injection attempt blocked', severity: 'critical' },
        { msg: 'XSS payload detected in user input', severity: 'high' },
        { msg: 'Brute force attack on SSH port', severity: 'critical' },
        { msg: 'Malicious file upload blocked', severity: 'high' }
      ];
      const alert = msgs[Math.floor(Math.random() * msgs.length)];
      setAlerts(prev => [{ id: Date.now(), ...alert, timestamp: new Date().toISOString() }, ...prev.slice(0, 99)]);
    }, 4000);
  };

  const runAIAnalysis = async () => {
    setAiAnalyzing(true);
    try {
      const response = await fetch("https://api.anthropic.com/v1/messages", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          model: "claude-sonnet-4-20250514",
          max_tokens: 1500,
          messages: [{
            role: "user",
            content: `Analyze these cybersecurity threats and provide actionable recommendations:

THREATS: ${JSON.stringify(threats)}
VULNERABILITIES: ${JSON.stringify(vulnerabilities)}

Return ONLY valid JSON:
{
  "riskScore": <0-100>,
  "findings": [<4 findings>],
  "actions": [<5 immediate actions>],
  "tools": [<3 recommended security tools to use>]
}`
          }]
        })
      });

      const data = await response.json();
      let text = data.content.find(c => c.type === 'text')?.text || '{}';
      text = text.replace(/```json|```/g, '').trim();
      const analysis = JSON.parse(text);
      const updated = [{ id: Date.now(), analysis, timestamp: new Date().toISOString() }, ...aiInsights.slice(0, 9)];
      setAiInsights(updated);
      save('ai-tools', updated);
    } catch (error) {
      const fallback = {
        id: Date.now(),
        analysis: {
          riskScore: 91,
          findings: [
            'Active APT41 C2 communication detected - persistent backdoor in environment',
            'LockBit ransomware ready to deploy - immediate containment required',
            'Kerberoasting indicates AD compromise - reset all service account passwords',
            'Multiple critical CVEs unpatched - container escape and RCE vulnerabilities present'
          ],
          actions: [
            'Isolate compromised hosts immediately',
            'Block C2 IPs: 45.33.32.156 at firewall',
            'Deploy patches for CVE-2024-21626 and CVE-2024-4577',
            'Reset all AD service account passwords',
            'Run full network scan with tools below'
          ],
          tools: [
            'Use Hash Calculator to verify file integrity',
            'Use Port Scanner to identify open services',
            'Use Encryption Tool to secure sensitive data'
          ]
        },
        timestamp: new Date().toISOString()
      };
      const updated = [fallback, ...aiInsights.slice(0, 9)];
      setAiInsights(updated);
      save('ai-tools', updated);
    }
    setAiAnalyzing(false);
  };

  const generatePassword = () => {
    let chars = '';
    if (passwordConfig.lower) chars += 'abcdefghijklmnopqrstuvwxyz';
    if (passwordConfig.upper) chars += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    if (passwordConfig.numbers) chars += '0123456789';
    if (passwordConfig.symbols) chars += '!@#$%^&*()_+-=[]{}|;:,.<>?';
    
    let pwd = '';
    const array = new Uint32Array(passwordConfig.length);
    crypto.getRandomValues(array);
    for (let i = 0; i < passwordConfig.length; i++) {
      pwd += chars.charAt(array[i] % chars.length);
    }
    setGeneratedPassword(pwd);
    
    const entropy = Math.floor(Math.log2(Math.pow(chars.length, pwd.length)));
    const cred = {
      id: Date.now(),
      password: pwd,
      entropy,
      created: new Date().toISOString()
    };
    const updated = [cred, ...credentials.slice(0, 19)];
    setCredentials(updated);
    save('creds-tools', updated);
  };

  const calculateHashes = async () => {
    if (!hashInput) return;
    
    const encoder = new TextEncoder();
    const data = encoder.encode(hashInput);
    
    const sha256Hash = await crypto.subtle.digest('SHA-256', data);
    const sha256Hex = Array.from(new Uint8Array(sha256Hash)).map(b => b.toString(16).padStart(2, '0')).join('');
    
    const sha1Hash = await crypto.subtle.digest('SHA-1', data);
    const sha1Hex = Array.from(new Uint8Array(sha1Hash)).map(b => b.toString(16).padStart(2, '0')).join('');
    
    setHashResults({
      md5: 'MD5 not available in Web Crypto API',
      sha1: sha1Hex,
      sha256: sha256Hex
    });
  };

  const simulatePortScan = () => {
    setPortScanning(true);
    setTimeout(() => {
      const commonPorts = [
        { port: 21, service: 'FTP', status: 'closed', risk: 'low' },
        { port: 22, service: 'SSH', status: 'open', risk: 'medium' },
        { port: 80, service: 'HTTP', status: 'open', risk: 'low' },
        { port: 443, service: 'HTTPS', status: 'open', risk: 'low' },
        { port: 3306, service: 'MySQL', status: 'open', risk: 'high' },
        { port: 3389, service: 'RDP', status: 'filtered', risk: 'medium' },
        { port: 5432, service: 'PostgreSQL', status: 'closed', risk: 'low' },
        { port: 8080, service: 'HTTP-Proxy', status: 'open', risk: 'medium' }
      ];
      setPortScanResults(commonPorts);
      setPortScanning(false);
    }, 2000);
  };

  const encryptData = () => {
    if (!encryptText || !encryptKey) return;
    
    // Simple XOR encryption for demonstration
    let encrypted = '';
    for (let i = 0; i < encryptText.length; i++) {
      encrypted += String.fromCharCode(encryptText.charCodeAt(i) ^ encryptKey.charCodeAt(i % encryptKey.length));
    }
    setEncryptedResult(btoa(encrypted));
  };

  const convertBase64 = () => {
    if (!base64Input) return;
    
    try {
      if (base64Mode === 'encode') {
        setBase64Output(btoa(base64Input));
      } else {
        setBase64Output(atob(base64Input));
      }
    } catch (error) {
      setBase64Output('Error: Invalid input');
    }
  };

  const testSQLInjection = () => {
    if (!sqlInput) return;
    
    const patterns = [
      { pattern: /('|--|;|\/\*|\*\/)/g, name: 'SQL Comment/Quote', risk: 'High' },
      { pattern: /(union|select|insert|update|delete|drop|create|alter)/gi, name: 'SQL Keywords', risk: 'Critical' },
      { pattern: /(or|and)\s+[\d\w]+\s*=\s*[\d\w]+/gi, name: 'Boolean-based SQLi', risk: 'Critical' },
      { pattern: /(\bor\b|\band\b)\s+['"]?1['"]?\s*=\s*['"]?1['"]?/gi, name: 'Tautology', risk: 'Critical' }
    ];
    
    const results = patterns.filter(p => p.pattern.test(sqlInput)).map(p => ({
      ...p,
      found: true
    }));
    
    setSqlResults(results.length > 0 ? results : [{ name: 'No SQL injection patterns detected', risk: 'Safe', found: false }]);
  };

  const generateXSSPayloads = () => {
    const payloads = [
      '<script>alert(\'XSS\')</script>',
      '<img src=x onerror=alert(\'XSS\')>',
      '<svg onload=alert(\'XSS\')>',
      'javascript:alert(\'XSS\')',
      '<iframe src="javascript:alert(\'XSS\')">',
      '<body onload=alert(\'XSS\')>',
      '<input autofocus onfocus=alert(\'XSS\')>',
      '<marquee onstart=alert(\'XSS\')>'
    ];
    setXssPayloads(payloads);
  };

  const copy = (text) => {
    navigator.clipboard.writeText(text);
    setCopied(true);
    setTimeout(() => setCopied(false), 2000);
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black p-6">
      <div className="max-w-7xl mx-auto">
        <div className="mb-8 bg-gradient-to-r from-green-600 to-emerald-600 rounded-2xl p-6 shadow-2xl">
          <div className="flex items-center gap-4">
            <Shield className="w-12 h-12 text-white" />
            <div>
              <h1 className="text-4xl font-black text-white">CYBERSECURITY TOOLKIT</h1>
              <p className="text-white text-lg">Professional Security Testing & Analysis Tools</p>
            </div>
          </div>
        </div>

        <div className="bg-gray-800 rounded-xl mb-6 border-2 border-green-500">
          <div className="flex overflow-x-auto">
            {[
              { id: 'dashboard', name: 'Dashboard', icon: Activity },
              { id: 'ai', name: 'AI Analysis', icon: Brain },
              { id: 'hash', name: 'Hash Calculator', icon: Hash },
              { id: 'portscan', name: 'Port Scanner', icon: Network },
              { id: 'encrypt', name: 'Encryption', icon: Lock },
              { id: 'base64', name: 'Base64', icon: Binary },
              { id: 'sqli', name: 'SQL Injection', icon: Database },
              { id: 'xss', name: 'XSS Payloads', icon: Code },
              { id: 'password', name: 'Password Gen', icon: Key }
            ].map(tab => {
              const Icon = tab.icon;
              return (
                <button
                  key={tab.id}
                  onClick={() => setActiveTab(tab.id)}
                  className={`flex items-center gap-2 px-6 py-4 font-bold transition-all ${
                    activeTab === tab.id
                      ? 'bg-green-600 text-white'
                      : 'text-gray-300 hover:bg-gray-700'
                  }`}
                >
                  <Icon className="w-5 h-5" />
                  {tab.name}
                </button>
              );
            })}
          </div>
        </div>

        {activeTab === 'dashboard' && (
          <div className="space-y-6">
            <div className="grid grid-cols-4 gap-4">
              {[
                { label: 'Critical Threats', value: threats.filter(t => t.severity === 'critical').length, color: 'from-red-600 to-red-700' },
                { label: 'Vulnerabilities', value: vulnerabilities.length, color: 'from-orange-600 to-orange-700' },
                { label: 'Active Scans', value: '3', color: 'from-blue-600 to-blue-700' },
                { label: 'Security Score', value: '87%', color: 'from-green-600 to-green-700' }
              ].map((stat, i) => (
                <div key={i} className={`bg-gradient-to-br ${stat.color} rounded-xl p-6 text-white`}>
                  <p className="text-5xl font-black">{stat.value}</p>
                  <p className="text-lg font-bold mt-2">{stat.label}</p>
                </div>
              ))}
            </div>

            <div className="grid grid-cols-2 gap-6">
              <div className="bg-gray-800 rounded-xl p-6 border-2 border-gray-700">
                <h2 className="text-2xl font-bold text-white mb-4">Live Alerts</h2>
                <div className="space-y-2 max-h-64 overflow-y-auto">
                  {alerts.slice(0, 6).map(alert => (
                    <div key={alert.id} className={`p-3 rounded-lg ${
                      alert.severity === 'critical' ? 'bg-red-900 border-l-4 border-red-500' : 'bg-yellow-900 border-l-4 border-yellow-500'
                    }`}>
                      <p className="text-white font-bold text-sm">{alert.message}</p>
                      <p className="text-gray-300 text-xs">{new Date(alert.timestamp).toLocaleTimeString()}</p>
                    </div>
                  ))}
                </div>
              </div>

              <div className="bg-gray-800 rounded-xl p-6 border-2 border-gray-700">
                <h2 className="text-2xl font-bold text-white mb-4">Threat Activity</h2>
                <ResponsiveContainer width="100%" height={200}>
                  <AreaChart data={metrics}>
                    <CartesianGrid strokeDasharray="3 3" stroke="#444" />
                    <XAxis dataKey="hour" stroke="#999" />
                    <YAxis stroke="#999" />
                    <Tooltip contentStyle={{ backgroundColor: '#1f2937', border: '1px solid #4b5563' }} />
                    <Area type="monotone" dataKey="threats" stroke="#ef4444" fill="#ef4444" fillOpacity={0.6} />
                    <Area type="monotone" dataKey="blocked" stroke="#10b981" fill="#10b981" fillOpacity={0.6} />
                  </AreaChart>
                </ResponsiveContainer>
              </div>
            </div>

            <div className="bg-gray-800 rounded-xl p-6 border-2 border-gray-700">
              <h2 className="text-2xl font-bold text-white mb-4">Active Threats</h2>
              <div className="space-y-4">
                {threats.map(t => (
                  <div key={t.id} className="bg-gray-900 border-l-4 border-red-600 p-4 rounded-lg">
                    <div className="flex items-start justify-between">
                      <div className="flex-1">
                        <div className="flex items-center gap-2 mb-2">
                          <span className="px-3 py-1 bg-red-600 text-white rounded-lg text-xs font-bold">{t.severity.toUpperCase()}</span>
                          <span className="px-3 py-1 bg-blue-600 text-white rounded-lg text-xs font-bold">{t.confidence}% Confidence</span>
                        </div>
                        <h3 className="text-white font-bold text-lg mb-1">{t.name}</h3>
                        <p className="text-gray-300 text-sm mb-2">{t.desc}</p>
                        <div className="flex gap-2">
                          {t.iocs.map((ioc, i) => (
                            <span key={i} className="text-xs bg-gray-700 text-green-400 px-2 py-1 rounded font-mono">{ioc}</span>
                          ))}
                        </div>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        )}

        {activeTab === 'ai' && (
          <div className="bg-gray-800 rounded-xl p-6 border-2 border-gray-700">
            <div className="flex items-center justify-between mb-6">
              <h2 className="text-3xl font-bold text-white">AI Threat Analysis</h2>
              <button
                onClick={runAIAnalysis}
                disabled={aiAnalyzing}
                className="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center gap-2 font-bold"
              >
                {aiAnalyzing ? <RefreshCw className="w-5 h-5 animate-spin" /> : <Zap className="w-5 h-5" />}
                {aiAnalyzing ? 'Analyzing...' : 'Run AI Analysis'}
              </button>
            </div>
            
            {aiInsights.length > 0 ? (
              <div className="space-y-4">
                <div className="bg-red-900 border-2 border-red-600 p-6 rounded-xl">
                  <div className="flex items-center justify-between">
                    <span className="text-xl font-bold text-white">RISK SCORE</span>
                    <span className="text-6xl font-black text-red-400">{aiInsights[0].analysis.riskScore}</span>
                  </div>
                </div>
                
                <div className="bg-gray-900 p-4 rounded-xl">
                  <h3 className="text-xl font-bold text-white mb-3">Critical Findings</h3>
                  <div className="space-y-2">
                    {aiInsights[0].analysis.findings.map((f, i) => (
                      <div key={i} className="bg-red-950 border-l-4 border-red-500 p-3 rounded">
                        <p className="text-red-200">{f}</p>
                      </div>
                    ))}
                  </div>
                </div>
                
                <div className="bg-gray-900 p-4 rounded-xl">
                  <h3 className="text-xl font-bold text-white mb-3">Immediate Actions</h3>
                  <div className="space-y-2">
                    {aiInsights[0].analysis.actions.map((a, i) => (
                      <div key={i} className="flex items-start gap-2 bg-green-950 p-3 rounded">
                        <CheckCircle className="w-5 h-5 text-green-400 flex-shrink-0 mt-0.5" />
                        <p className="text-green-200">{a}</p>
                      </div>
                    ))}
                  </div>
                </div>
                
                <div className="bg-gray-900 p-4 rounded-xl">
                  <h3 className="text-xl font-bold text-white mb-3">Recommended Tools</h3>
                  <div className="space-y-2">
                    {aiInsights[0].analysis.tools.map((t, i) => (
                      <div key={i} className="bg-blue-950 border-l-4 border-blue-500 p-3 rounded">
                        <p className="text-blue-200">{t}</p>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            ) : (
              <div className="text-center py-12 text-gray-400">
                <Brain className="w-20 h-20 mx-auto mb-4" />
                <p className="text-xl">Click "Run AI Analysis" for threat assessment</p>
              </div>
            )}
          </div>
        )}

        {activeTab === 'hash' && (
          <div className="bg-gray-800 rounded-xl p-6 border-2 border-gray-700">
            <h2 className="text-3xl font-bold text-white mb-6">Hash Calculator</h2>
            <div className="space-y-4">
              <div>
                <label className="block text-white font-bold mb-2">Input Text</label>
                <textarea
                  value={hashInput}
                  onChange={(e) => setHashInput(e.target.value)}
                  className="w-full bg-gray-900 text-white p-4 rounded-lg border-2 border-gray-600 font-mono"
                  rows="4"
                  placeholder="Enter text to hash..."
                />
              </div>
              <button
                onClick={calculateHashes}
                className="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-bold"
              >
                Calculate Hashes
              </button>
              
              {hashResults && (
                <div className="space-y-3 mt-4">
                  <div className="bg-gray-900 p-4 rounded-lg">
                    <p className="text-gray-400 text-sm mb-1">SHA-256</p>
                    <div className="flex items-center gap-2">
                      <p className="text-green-400 font-mono text-sm flex-1 break-all">{hashResults.sha256}</p>
                      <button onClick={() => copy(hashResults.sha256)} className="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700">
                        {copied ? <Check className="w-4 h-4" /> : <Copy className="w-4 h-4" />}
                      </button>
                    </div>
                  </div>
                  <div className="bg-gray-900 p-4 rounded-lg">
                    <p className="text-gray-400 text-sm mb-1">SHA-1</p>
                    <div className="flex items-center gap-2">
                      <p className="text-green-400 font-mono text-sm flex-1 break-all">{hashResults.sha1}</p>
                      <button onClick={() => copy(hashResults.sha1)} className="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700">
                        <Copy className="w-4 h-4" />
                      </button>
                    </div>
                  </div>
                </div>
              )}
            </div>
          </div>
        )}

        {activeTab === 'portscan' && (
          <div className="bg-gray-800 rounded-xl p-6 border-2 border-gray-700">
            <h2 className="text-3xl font-bold text-white mb-6">Port Scanner</h2>
            <div className="space-y-4">
              <div>
                <label className="block text-white font-bold mb-2">Target IP/Domain</label>
                <input
                  type="text"
                  value={targetIP}
                  onChange={(e) => setTargetIP(e.target.value)}
                  className="w-full bg-gray-900 text-white p-3 rounded-lg border-2 border-gray-600"
                  placeholder="192.168.1.1"
                />
              </div>
              <button
                onClick={simulatePortScan}
                disabled={portScanning}
                className="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-bold disabled:opacity-50"
              >
                {portScanning ? 'Scanning...' : 'Scan Ports'}
              </button>
              
              {portScanResults.length > 0 && (
                <div className="mt-4">
                  <h3 className="text-xl font-bold text-white mb-3">Scan Results</h3>
                  <div className="space-y-2">
                    {portScanResults.map((result, i) => (
                      <div key={i} className={`p-3 rounded-lg flex items-center justify-between ${
                        result.status === 'open' ? 'bg-red-900 border-l-4 border-red-500' :
                        result.status === 'filtered' ? 'bg-yellow-900 border-l-4 border-yellow-500' :
                        'bg-green-900 border-l-4 border-green-500'
                      }`}>
                        <div>
                          <span className="text-white font-bold">Port {result.port}</span>
                          <span className="text-gray-300 ml-2">({result.service})</span>
                        </div>
                        <div className="flex items-center gap-2">
                          <span className={`px-3 py-1 rounded-lg font-bold ${
                            result.status === 'open' ? 'bg-red-600' :
                            result.status === 'filtered' ? 'bg-yellow-600' :
                            'bg-green-600'
                          } text-white`}>
                            {result.status.toUpperCase()}
                          </span>
                          <span className={`text-xs ${
                            result.risk === 'high' ? 'text-red-400' :
                            result.risk === 'medium' ? 'text-yellow-400' :
                            'text-green-400'
                          }`}>
                            {result.risk.toUpperCase()} RISK
                          </span>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>
          </div>
        )}

        {activeTab === 'encrypt' && (
          <div className="bg-gray-800 rounded-xl p-6 border-2 border-gray-700">
            <h2 className="text-3xl font-bold text-white mb-6">Encryption Tool</h2>
            <div className="space-y-4">
              <div>
                <label className="block text-white font-bold mb-2">Text to Encrypt</label>
                <textarea
                  value={encryptText}
                  onChange={(e) => setEncryptText(e.target.value)}
                  className="w-full bg-gray-900 text-white p-4 rounded-lg border-2 border-gray-600"
                  rows="3"
                  placeholder="Enter text..."
                />
              </div>
              <div>
                <label className="block text-white font-bold mb-2">Encryption Key</label>
                <input
                  type="text"
                  value={encryptKey}
                  onChange={(e) => setEncryptKey(e.target.value)}
                  className="w-full bg-gray-900 text-white p-3 rounded-lg border-2 border-gray-600"
                  placeholder="Enter key..."
                />
              </div>
              <button
                onClick={encryptData}
                className="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-bold"
              >
                Encrypt (XOR)
              </button>
              
              {encryptedResult && (
                <div className="bg-gray-900 p-4 rounded-lg">
                  <p className="text-gray-400 text-sm mb-2">Encrypted Result (Base64)</p>
                  <div className="flex items-center gap-2">
                    <p className="text-green-400 font-mono text-sm flex-1 break-all">{encryptedResult}</p>
                    <button onClick={() => copy(encryptedResult)} className="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700">
                      <Copy className="w-4 h-4" />
                    </button>
                  </div>
                </div>
              )}
            </div>
          </div>
        )}

        {activeTab === 'base64' && (
          <div className="bg-gray-800 rounded-xl p-6 border-2 border-gray-700">
            <h2 className="text-3xl font-bold text-white mb-6">Base64 Encoder/Decoder</h2>
            <div className="space-y-4">
              <div className="flex gap-4 mb-4">
                <button
                  onClick={() => setBase64Mode('encode')}
                  className={`px-6 py-2 rounded-lg font-bold ${
                    base64Mode === 'encode' ? 'bg-green-600 text-white' : 'bg-gray-700 text-gray-300'
                  }`}
                >
                  Encode
                </button>
                <button
                  onClick={() => setBase64Mode('decode')}
                  className={`px-6 py-2 rounded-lg font-bold ${
                    base64Mode === 'decode' ? 'bg-green-600 text-white' : 'bg-gray-700 text-gray-300'
                  }`}
                >
                  Decode
                </button>
              </div>
              <div>
                <label className="block text-white font-bold mb-2">Input</label>
                <textarea
                  value={base64Input}
                  onChange={(e) => setBase64Input(e.target.value)}
                  className="w-full bg-gray-900 text-white p-4 rounded-lg border-2 border-gray-600 font-mono"
                  rows="4"
                  placeholder={base64Mode === 'encode' ? 'Enter text to encode...' : 'Enter Base64 to decode...'}
                />
              </div>
              <button
                onClick={convertBase64}
                className="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-bold"
              >
                {base64Mode === 'encode' ? 'Encode' : 'Decode'}
              </button>
              
              {base64Output && (
                <div className="bg-gray-900 p-4 rounded-lg">
                  <p className="text-gray-400 text-sm mb-2">Output</p>
                  <div className="flex items-center gap-2">
                    <p className="text-green-400 font-mono text-sm flex-1 break-all">{base64Output}</p>
                    <button onClick={() => copy(base64Output)} className="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700">
                      <Copy className="w-4 h-4" />
                    </button>
                  </div>
                </div>
              )}
            </div>
          </div>
        )}

        {activeTab === 'sqli' && (
          <div className="bg-gray-800 rounded-xl p-6 border-2 border-gray-700">
            <h2 className="text-3xl font-bold text-white mb-6">SQL Injection Tester</h2>
            <div className="space-y-4">
              <div>
                <label className="block text-white font-bold mb-2">Test Input</label>
                <textarea
                  value={sqlInput}
                  onChange={(e) => setSqlInput(e.target.value)}
                  className="w-full bg-gray-900 text-white p-4 rounded-lg border-2 border-gray-600 font-mono"
                  rows="3"
                  placeholder="' OR '1'='1"
                />
              </div>
              <button
                onClick={testSQLInjection}
                className="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-bold"
              >
                Test for SQL Injection
              </button>
              
              {sqlResults.length > 0 && (
                <div className="mt-4">
                  <h3 className="text-xl font-bold text-white mb-3">Detection Results</h3>
                  <div className="space-y-2">
                    {sqlResults.map((result, i) => (
                      <div key={i} className={`p-3 rounded-lg ${
                        result.risk === 'Critical' ? 'bg-red-900 border-l-4 border-red-500' :
                        result.risk === 'High' ? 'bg-orange-900 border-l-4 border-orange-500' :
                        'bg-green-900 border-l-4 border-green-500'
                      }`}>
                        <div className="flex items-center justify-between">
                          <span className="text-white font-bold">{result.name}</span>
                          <span className={`px-3 py-1 rounded-lg font-bold text-sm ${
                            result.risk === 'Critical' ? 'bg-red-600' :
                            result.risk === 'High' ? 'bg-orange-600' :
                            'bg-green-600'
                          } text-white`}>
                            {result.risk}
                          </span>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>
          </div>
        )}

        {activeTab === 'xss' && (
          <div className="bg-gray-800 rounded-xl p-6 border-2 border-gray-700">
            <h2 className="text-3xl font-bold text-white mb-6">XSS Payload Generator</h2>
            <button
              onClick={generateXSSPayloads}
              className="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-bold mb-6"
            >
              Generate XSS Payloads
            </button>
            
            {xssPayloads.length > 0 && (
              <div className="space-y-3">
                {xssPayloads.map((payload, i) => (
                  <div key={i} className="bg-gray-900 p-4 rounded-lg border-2 border-yellow-600">
                    <div className="flex items-center justify-between gap-2">
                      <code className="text-yellow-400 text-sm flex-1 break-all">{payload}</code>
                      <button onClick={() => copy(payload)} className="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700">
                        <Copy className="w-4 h-4" />
                      </button>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>
        )}

        {activeTab === 'password' && (
          <div className="bg-gray-800 rounded-xl p-6 border-2 border-gray-700">
            <h2 className="text-3xl font-bold text-white mb-6">Password Generator</h2>
            <div className="space-y-4">
              <div>
                <label className="block text-white font-bold mb-2">Length: {passwordConfig.length}</label>
                <input
                  type="range"
                  min="8"
                  max="64"
                  value={passwordConfig.length}
                  onChange={(e) => setPasswordConfig({...passwordConfig, length: parseInt(e.target.value)})}
                  className="w-full"
                />
              </div>
              <div className="grid grid-cols-2 gap-4">
                {[
                  { key: 'upper', label: 'Uppercase' },
                  { key: 'lower', label: 'Lowercase' },
                  { key: 'numbers', label: 'Numbers' },
                  { key: 'symbols', label: 'Symbols' }
                ].map(opt => (
                  <label key={opt.key} className="flex items-center gap-2 text-white">
                    <input
                      type="checkbox"
                      checked={passwordConfig[opt.key]}
                      onChange={(e) => setPasswordConfig({...passwordConfig, [opt.key]: e.target.checked})}
                      className="w-5 h-5"
                    />
                    {opt.label}
                  </label>
                ))}
              </div>
              <button
                onClick={generatePassword}
                className="w-full px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 font-bold text-lg"
              >
                Generate Password
              </button>
              
              {generatedPassword && (
                <div className="bg-gray-900 p-4 rounded-lg border-2 border-green-500">
                  <div className="flex items-center gap-2">
                    <p className="text-green-400 font-mono text-2xl flex-1 break-all">{generatedPassword}</p>
                    <button onClick={() => copy(generatedPassword)} className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                      {copied ? <Check className="w-5 h-5" /> : <Copy className="w-5 h-5" />}
                    </button>
                  </div>
                </div>
              )}
              
              <div className="mt-6">
                <h3 className="text-xl font-bold text-white mb-3">Recent Passwords</h3>
                <div className="space-y-2">
                  {credentials.slice(0, 5).map(c => (
                    <div key={c.id} className="bg-gray-900 p-3 rounded-lg flex items-center justify-between">
                      <p className="text-green-400 font-mono flex-1 break-all">{c.password}</p>
                      <button onClick={() => copy(c.password)} className="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 ml-2">
                        <Copy className="w-4 h-4" />
                      </button>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          </div>
        )}
      </div>
    </div>
  );
}
